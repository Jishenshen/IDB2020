select subquery.uun,subquery.name from (select subquery.uun,subquery.name,subquery.degree,count(subquery.course) from (select * from students s1, exams e1 where s1.uun=e1.student) as subquery group by subquery.uun,subquery.name,subquery.degree) as subquery,(select p1.degree, count(p1.course) from programmes p1 group by degree) as subpro where subquery.degree = subpro.degree and subquery.count=subpro.count order by subquery.uun;
